LOAD 'agensgraph';
SET search_path TO ag_catalog;
--
-- map literal
--
-- empty map
SELECT * FROM cypher($$RETURN {}$$) AS r(c agtype);
ERROR:  map literal parsed
LINE 1: SELECT * FROM cypher($$RETURN {}$$) AS r(c agtype);
                                      ^
DETAIL:  <>
-- map of scalar values
SELECT * FROM cypher($$
RETURN {s: 's', i: 1, f: 1.0, b: true, z: null}
$$) AS r(c agtype);
ERROR:  map literal parsed
LINE 2: RETURN {s: 's', i: 1, f: 1.0, b: true, z: null}
               ^
DETAIL:  ("s" {A_CONST :val "s" :location 12} "i" {A_CONST :val 1 :location 20} "f" {A_CONST :val 1.0 :location 26} "b" {EXTENSIBLENODE :extnodename cypher_bool_const :boolean true :location 34} "z" {A_CONST :val NULL :location 43})
--
-- list literal
--
-- empty list
SELECT * FROM cypher($$RETURN []$$) AS r(c agtype);
ERROR:  list literal parsed
LINE 1: SELECT * FROM cypher($$RETURN []$$) AS r(c agtype);
                                      ^
DETAIL:  <>
-- list of scalar values
SELECT * FROM cypher($$RETURN ['str', 1, 1.0, true, null]$$) AS r(c agtype);
ERROR:  list literal parsed
LINE 1: SELECT * FROM cypher($$RETURN ['str', 1, 1.0, true, null]$$)...
                                      ^
DETAIL:  ({A_CONST :val "str" :location 8} {A_CONST :val 1 :location 15} {A_CONST :val 1.0 :location 18} {EXTENSIBLENODE :extnodename cypher_bool_const :boolean true :location 23} {A_CONST :val NULL :location 29})
--
-- Test transform logic for operators
--
SELECT * FROM cypher(
$$ RETURN (-(3 * 2 - 4.0) ^ ((10 / 5) + 1)) % -3 $$
)
AS r(result agtype);
 result 
--------
 -2.0
(1 row)

--
-- Test transform logic for comparison operators
--
SELECT * FROM cypher(
$$ RETURN 1 = 1.0 $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN 1 > -1.0 $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN -1.0 < 1 $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN "aaa" < "z" $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN "z" > "aaa" $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN false = false $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN ("string" < true) $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN true < 1 $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN (1 + 1.0) = (7 % 5) $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

--
-- Test transform logic for IS NULL & IS NOT NULL
--
SELECT * FROM cypher(
$$ RETURN null IS NULL $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN 1 IS NULL $$
)
AS r(result boolean);
 result 
--------
 f
(1 row)

SELECT * FROM cypher(
$$ RETURN 1 IS NOT NULL $$
)
AS r(result boolean);
 result 
--------
 t
(1 row)

SELECT * FROM cypher(
$$ RETURN null IS NOT NULL $$
)
AS r(result boolean);
 result 
--------
 f
(1 row)

--
-- End of tests
--
